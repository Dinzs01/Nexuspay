 {% extends "base.html" %}
{% block content %}
<h2>Admin Panel</h2>

<h3>Users</h3>
<table border="1" cellpadding="6">
  <tr><th>ID</th><th>Username</th><th>Email</th><th>Balance</th><th>Referral</th></tr>
  {% for u in users %}
  <tr>
    <td>{{ u['id'] }}</td>
    <td>{{ u['username'] }}</td>
    <td>{{ u['email'] }}</td>
    <td>{{ '%.4f'|format(u['balance']) }}</td>
    <td>{{ u['referral_code'] }}</td>
  </tr>
  {% endfor %}
</table>

<h3>Withdrawals</h3>
<table border="1" cellpadding="6">
  <tr><th>ID</th><th>User</th><th>Amount</th><th>Status</th><th>Action</th></tr>
  {% for w in withdrawals %}
  <tr>
    <td>{{ w['id'] }}</td>
    <td>{{ w['username'] }}</td>
    <td>{{ '%.4f'|format(w['amount']) }}</td>
    <td>{{ w['status'] }}</td>
    <td>
      {% if w['status'] == 'pending' %}
      <form style="display:inline" method="post" action="{{ url_for('process_withdrawal', w_id=w['id']) }}">
        <button name="action" value="approve">Approve</button>
      </form>
      <form style="display:inline" method="post" action="{{ url_for('process_withdrawal', w_id=w['id']) }}">
        <button name="action" value="reject">Reject</button>
      </form>
      {% else %}
      -
      {% endif %}
    </td>
  </tr>
  {% endfor %}
</table>

{% endblock %}

